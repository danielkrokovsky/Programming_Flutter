
<!-- saved from url=(0049)http://localhost:8080/html/Cap%C3%ADtulo-072.html -->
<html xmlns="http://www.w3.org/1999/xhtml" class="translated-ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Flutter de programação</title>
  <link href="./Capítulo-072_files/bookshelf.css" rel="stylesheet" type="text/css">
  <link href="./Capítulo-072_files/book_local.css" rel="stylesheet" type="text/css">
  <meta content="urn:uuid:08781442-9212-4868-bf02-b4ef0fd56427" name="Adept.expected.resource">
<link type="text/css" rel="stylesheet" charset="UTF-8" href="./Capítulo-072_files/translateelement.css"></head>

<body>

  <h2 id="d24e30840"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testando o aplicativo XKCD: usando objetos simulados</font></font></h2>

  <p id="d24e30843"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">


Testar o aplicativo XKCD apresenta um desafio: o aplicativo depende de variáveis ​​externas: uma conexão com a Internet precisa estar presente e o aplicativo precisa ser capaz de se conectar aos servidores XKCD (que precisam estar ativos) para funcionar. </font><font style="vertical-align: inherit;">O problema com isso é que podemos precisar testar apenas uma pequena parte de nosso aplicativo (especialmente durante o teste de unidade) sem precisar fazer interface com nada mais, e precisamos simular arquivos, já que não podemos acessá-los de qualquer maneira. </font><font style="vertical-align: inherit;">Para fazer isso, os desenvolvedores geralmente recorrem à construção de </font></font><span class="emph"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">objetos fictícios</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que são objetos que simulam os recursos fornecidos pela interface externa, mas não exigem essa interface.</font></font></p>

  <p id="d24e30860"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Construir objetos fictícios não é específico para linguagem ou estrutura, mas o Google desenvolveu um pacote Flutter que permite aos desenvolvedores simplificar a criação de objetos fictícios: a biblioteca Mockito.</font></font></p>

  <h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A Biblioteca Mockito</font></font></h3>

  <p id="d24e30865"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">

O </font><font style="vertical-align: inherit;">pacote </font></font><span class="emph"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mockito</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> desenvolvido pelo Google </font><font style="vertical-align: inherit;">no Pub </font></font><sup><a class="footnote" href="http://localhost:8080/html/Cap%C3%ADtulo-075.html#FOOTNOTE-44" id="FNPTR-44"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[44]</font></font></a></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> permite que você escreva classes que reproduzem um comportamento que você escolher usando a </font><font style="vertical-align: inherit;">função </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">when</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p>

  <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escrevendo um Objeto Simulado</font></font></h4>

  <p id="d24e30896"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">

Como exemplo, vamos escrever um substituto para o </font></font><span class="cf constant"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> constante usamos no aplicativo XKCD para fazer solicitações para que possamos testar a </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getLatestNumber</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> métodos. </font><font style="vertical-align: inherit;">É um objeto da classe </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cliente</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , para que escrever uma classe vazia que </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se estende</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font><a href="http://localhost:8080/html/Cap%C3%ADtulo-092.html#sec.dart.extends"><em><font style="vertical-align: inherit;">estende</font></em></a><font style="vertical-align: inherit;"> ) </font><span class="cf class"><font style="vertical-align: inherit;">Mock</font></span><font style="vertical-align: inherit;"> e </font><span class="cf ic"><font style="vertical-align: inherit;">implementos</font></span><font style="vertical-align: inherit;"> ( </font><a href="http://localhost:8080/html/Cap%C3%ADtulo-092.html#sec.dart.implements"><em><font style="vertical-align: inherit;">escrevendo uma classe que implementa uma interface</font></em></a><font style="vertical-align: inherit;"> ) </font><span class="cf class"><font style="vertical-align: inherit;">Cliente</font></span><font style="vertical-align: inherit;"> membros ‘s:</font></font><a href="http://localhost:8080/html/Cap%C3%ADtulo-092.html#sec.dart.extends"><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><span class="cf class"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font><span class="cf ic"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font><a href="http://localhost:8080/html/Cap%C3%ADtulo-092.html#sec.dart.implements"><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><span class="cf class"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/testing/xkcd_app/test/unit_test.dart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">testando / xkcd_app / test / unit_test.dart</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">importação </font></font></strong><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'pacote: http / http.dart' </font></font></em><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> http;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classe</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MockHTTPClient </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estende</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mock </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">implementos</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> http.Client {}</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e30962"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos definir dois quadrinhos que podemos retornar:</font></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/testing/xkcd_app/test/unit_test.dart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">testando / xkcd_app / test / unit_test.dart</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> banda desenhada = [</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"""</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  {</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    "</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mês </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">": "",</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    " </font></font></em><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Num </font></font></strong><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">": 1,</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    "</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ligação </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">": "",</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    "</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ano </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">": "",</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    "</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Notícias </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">": "",</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    "</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Safe_title </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">":"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The First Comic </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">",</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    "</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Transcrição </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">": "",</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    "</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Alt </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">":"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> primeiro alt-texto cômico </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">",</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    "</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Img </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">":"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> https: </font></font><em class="comment"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">//example.com/1.png",</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"título"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"The First Comic"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"dia"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">""</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">""",</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  """</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"mês"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">""</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"num"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 2,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"link"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">""</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Ano"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">""</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"notícia"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">""</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"safe_title"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"A Segunda Comic"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"transcrição"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">""</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"alt"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"segunda alt-text quadrinhos"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"img"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"https://example.com/2.png"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"título"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"A Segunda Comic"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"dia"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">""</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"""</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">];</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

  </tbody></table>

  <p id="d24e31161"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neste ponto, precisamos pensar sobre as chamadas que fazemos para </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http.read</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O primeiro deles é </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http.read ('https://xkcd.com/info.0.json')</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que deve retornar uma </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">String</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contendo a história em quadrinhos em um formato JSON, portanto, retornaremos a segunda história em quadrinhos:</font></font></p>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quando (mockHttp.read ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'https://xkcd.com/info.0.json'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )). thenReturn (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quadrinhos [1]</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">);</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e31189"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O mesmo também precisa ser aplicado para </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/$num/info.0.json</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , então também precisamos do seguinte:</font></font></p>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quando (mockHttp.read ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'https://xkcd.com/2/info.0.json'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )). thenReturn (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quadrinhos [1]</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">);</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e31212"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Precisamos estar prontos para retornar a história em quadrinhos número 1, já que isso será obtido em algum momento e precisamos estar prontos para isso:</font></font></p>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quando (mockHttp.read ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'https://xkcd.com/1/info.0.json'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )). thenReturn (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quadrinhos [0]</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">);</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e31231"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Também precisamos nos preocupar quando </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http.readBytes ()</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> será chamado para buscar uma imagem. </font><font style="vertical-align: inherit;">O problema com isso é que ele deve retornar um </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uint8List</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que é uma lista de inteiros de 8 bits (cada um deles é um byte). </font><font style="vertical-align: inherit;">Para criar um </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uint8List</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , precisamos primeiro importar a </font><font style="vertical-align: inherit;">biblioteca </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dart: typed_data</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">A maneira mais simples de criar um </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uint8List</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é chamando o </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uint8.fromList (lista)</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e passando um literal de lista.</font></font></p>

  <p id="d24e31252"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Depois disso, precisamos nos preocupar com o que devolver. </font><font style="vertical-align: inherit;">Neste caso, não nos importamos se os dados realmente representam uma imagem, já que não precisamos renderizá-la, precisamos apenas que seja algo que possamos prever - neste caso, a lista será apenas o quadrinho número:

</font></font></p>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quando (mockHttp.readBytes ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'https://example.com/1.png'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )). thenReturn (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  Uint8List.fromList ([1])</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">);</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quando (mockHttp.readBytes ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'https://example.com/2.png'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )). thenReturn (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  Uint8List.fromList ([2])</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">);</font></font></td>
    </tr>

  </tbody></table>

  <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Objeto de simulação de arquivo</font></font></strong></p>

  <p id="d24e31299"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Precisamos também criar objetos fictícios para arquivos e imagens.</font></font></p>

  <p id="d24e31301"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nesse caso, embora estejamos chamando as classes diretamente no aplicativo, precisamos implementar objetos de arquivo para passar para as funções. </font><font style="vertical-align: inherit;">Um exemplo será dado quando vemos </font><a href="http://localhost:8080/html/Cap%C3%ADtulo-072.html#sec.testing.latestcomic"><em><font style="vertical-align: inherit;">Testing </font></em></a><a href="http://localhost:8080/html/Cap%C3%ADtulo-072.html#sec.testing.latestcomic"><em><span class="cf methodname"><font style="vertical-align: inherit;">getLatestComicNumber</font></span></em></a><font style="vertical-align: inherit;"> .

</font></font><a href="http://localhost:8080/html/Cap%C3%ADtulo-072.html#sec.testing.latestcomic"><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font><span class="cf methodname"><font style="vertical-align: inherit;"></font></span></em><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p>

  <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usando o objeto mock</font></font></h4>

  <p id="d24e31311"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Precisamos fazer alterações nas funções que usam os objetos para os quais criamos objetos fictícios, para que eles possam receber o objeto fictício e usá-lo em vez do objeto real que usam atualmente.</font></font></p>

  <p id="d24e31317"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso significa que a </font><font style="vertical-align: inherit;">função </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getLatestComicNumber que</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> você vê no código a seguir precisa, em vez disso, tomar o </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cliente</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e o </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arquivo</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> personalizado </font><font style="vertical-align: inherit;">como um parâmetro:</font></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/networking/xkcd_app/lib/main.dart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">networking / xkcd_app / lib / main.dart</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Futuro &lt; </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt; getLatestComicNumber () assíncrona {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">definitiva</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dir = getTemporaryDirectory Await ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> file = Arquivo ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">' </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {dir.path} </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/latestComicNumber.txt'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n = 1;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tente</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    n = json.decode (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      Await http.read ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'https://xkcd.com/info.0.json'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    ) [ </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Num"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ];</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    file.exists (). then (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      (existe) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (existe!) file.createSync ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">        file.writeAsString ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">' </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ N </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

  </tbody></table>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">captura</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (e) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      file.existsSync () &amp;&amp;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      file.readAsStringSync ()! = </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">""</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    )</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      n = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .parse (file.readAsStringSync ());</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">regresso</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e31465"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O código atualizado deve ser o seguinte:</font></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/testing/xkcd_app/lib/main.dart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">testando / xkcd_app / lib / main.dart</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Futuro &lt; </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt; getLatestComicNumber</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">({http.Client httpClient, File latestComicNFile}) assíncrono</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (httpclient == </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    httpClient = http.Client ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (latestComicNFile == </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">definitiva</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dir = getTemporaryDirectory Await ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    latestComicNFile = Arquivo ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">' </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {dir.path} </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/latestComicNumber.txt'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n = 1;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tente</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    n = json.decode (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      Await httpClient.read ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'https://xkcd.com/info.0.json'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    ) [ </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Num"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ];</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    latestComicNFile.exists (). then (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      (existe) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (existe!) latestComicNFile.createSync ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">        latestComicNFile.writeAsString ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">' </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ N </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">captura</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (e) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestComicNFile.existsSync () &amp;&amp;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestComicNFile.readAsStringSync ()! = </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">""</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    )</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      n = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .parse (latestComicNFile.readAsStringSync ());</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">regresso</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e31635"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este método funciona como o mais antigo, quando nenhum argumento nomeado adicional é fornecido (eles seriam iguais a </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , disparando as </font><font style="vertical-align: inherit;">cláusulas </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if de</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fallback </font><font style="vertical-align: inherit;">), o que aconteceria durante o uso normal do aplicativo. </font><font style="vertical-align: inherit;">No entanto, se forem fornecidos, eles serão usados ​​no lugar do arquivo real e do cliente HTTP.</font></font></p>

  <p id="d24e31646"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obviamente, </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> também precisa ser alterado. </font><font style="vertical-align: inherit;">Vamos começar com o </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SelectionPage</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que era o seguinte no aplicativo original:</font></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/networking/xkcd_app/lib/main.dart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">networking / xkcd_app / lib / main.dart</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Futuro &lt;Map &lt; </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">string</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dinâmico</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt;&gt; _fetchComic ( </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cordas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n) async {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">definitiva</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dir = getTemporaryDirectory Await ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comicFile = Arquivo ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {dir.path} </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ n </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.json"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">   aguarde comicFile.exists () &amp;&amp;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">   comicFile.readAsStringSync ()! = </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">""</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> json.decode (comicFile.readAsStringSync ());</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">else</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">   comicFile.createSync ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">definitiva</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cómica = json.decode (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">     aguardam http.read ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'https://xkcd.com/ </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ n </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/info.0.json'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">   );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">   Arquivo ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">' </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {dir.path} </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ n </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.png'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">     .writeAsBytesSync (Await http.readBytes (cómica [ </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"img"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]));</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">   cômico [ </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"img"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] = </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">' </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {dir.path} </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ n </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.png'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">   comicFile.writeAsString (json.encode (comic));</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voltar</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> quadrinhos;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e31812"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e precisa se tornar o seguinte para permitir o teste usando os clientes e arquivos fornecidos como argumentos se forem fornecidos e revertendo para o padrão quando não forem (no uso normal do aplicativo), assim como fizemos para </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getLatestComicNumber</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/testing/xkcd_app/lib/main.dart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">testando / xkcd_app / lib / main.dart</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Futuro &lt;Map &lt; </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">string</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dinâmico</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt;&gt; fetchComic</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corda</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    http.Client httpClient,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    Arquivo comicFile,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    File imageFile,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cordas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imagepath</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) assíncrono</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  Diretório dir;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (httpclient == </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    httpClient = http.Client ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (comicFile == </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    dir = espera getTemporaryDirectory ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    comicFile = Arquivo ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {dir.path} </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ n </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.json"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (imageFile == </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (DIR == </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) dir = Await getTemporaryDirectory ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    ImagePath = </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">' </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {dir.path} </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ n </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.png'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    imageFile = Arquivo (imagePath);</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    aguarde comicFile.exists () &amp;&amp;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    comicFile.readAsStringSync ()! = </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">""</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  )</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> json.decode (comicFile.readAsStringSync ());</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">else</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    comicFile.createSync ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">definitiva</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cómica = json.decode (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      aguarde httpClient.read (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'https://xkcd.com/ </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ n </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/info.0.json'</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      )</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    imageFile.writeAsBytesSync (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      Await httpClient.readBytes (cómica [ </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"img"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ])</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    cómica [ </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"img"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] = imagepath;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    comicFile.writeAsString (json.encode (comic));</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voltar</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> quadrinhos;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e32042"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StarredPage</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é igual ao do </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SelectionPage</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , então as mesmas alterações se aplicam a ele.</font></font></p>

  <p id="d24e32053"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HomeScreen</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‘s </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> precisa de mudanças semelhantes (que é como o outro, mas desta vez, primeiro se preocupar em encontrar o número cômico subtraindo o </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> argumento para o último número quadrinhos):</font></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/testing/xkcd_app/lib/main.dart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">testando / xkcd_app / lib / main.dart</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Futuro &lt;Map &lt; </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">string</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dinâmico</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt;&gt; fetchComic</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    http.Client httpClient,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    Arquivo comicFile,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    File imageFile,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cordas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imagepath</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) assíncrono</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comicNumber = latestComic-n;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  Diretório dir;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (httpclient == </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    httpClient = http.Client ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (comicFile == </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    dir = espera getTemporaryDirectory ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    comicFile = Arquivo ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {dir.path} </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ comicNumber </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.json"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (imageFile == </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (DIR == </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) dir = Await getTemporaryDirectory ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    ImagePath = </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">' </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {dir.path} </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ comicNumber </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.png'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    imageFile = Arquivo (imagePath);</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    aguarde comicFile.exists () &amp;&amp;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    comicFile.readAsStringSync ()! = </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">""</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  )</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> json.decode (comicFile.readAsStringSync ());</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">else</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    comicFile.createSync ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">definitiva</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cómica = json.decode (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      aguarde httpClient.read (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'https://xkcd.com/ </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ comicNumber </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/info.0.json'</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      )</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    imageFile.writeAsBytesSync (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      Await httpClient.readBytes (cómica [ </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"img"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ])</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    cómica [ </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"img"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] = imagepath;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    comicFile.writeAsString (json.encode (comic));</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voltar</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> quadrinhos;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e32293"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ao tornar opcionais os argumentos adicionais que nos permitem fornecer objetos fictícios, podemos chamar esses métodos dentro do aplicativo sem ser forçados a passar os argumentos extras e mantemos a função o mais próximo possível do original, permitindo o uso de objetos fictícios.



</font></font></p>

  <h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escrevendo os testes</font></font></h3>

  <p id="d24e32305"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fizemos as alterações necessárias e agora precisamos escrever os testes para o aplicativo XKCD.</font></font></p>

  <h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testes de unidade de aplicativo XKCD</font></font></h3>

  <p id="d24e32310"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">


Precisamos testar se o aplicativo busca corretamente o último número de quadrinhos que, neste caso, é </font></font><span class="emph"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Também precisamos testar se ambos os </font><font style="vertical-align: inherit;">métodos </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_fetchComic são</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> executados conforme o esperado.</font></font></p>

  <p id="d24e32330"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos começar adicionando as classes simuladas que definimos anteriormente e importando tudo o que precisamos</font></font></p>

  <p id="d24e32332"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A última coisa de que precisamos fora de </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é a lista de strings de dados em quadrinhos, enquanto todas as chamadas para </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">when</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vão para dentro da </font><font style="vertical-align: inherit;">definição da função </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">principal</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p>

  <h4 id="sec.testing.latestcomic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testando </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getLatestComicNumber</font></font></span></h4>

  <p id="d24e32348"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos começar escrevendo um teste para </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getLatestComicNumber</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : para isso, precisaremos definir os objetos fictícios para o arquivo de número de quadrinhos mais recente e para o cliente http.</font></font></p>

  <p id="d24e32353"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Precisamos definir o comportamento para chamadas assíncronas e síncronas, pois precisamos que o teste funcione com uma implementação diferente também:</font></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/testing/xkcd_app/test/unit_test.dart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">testando / xkcd_app / test / unit_test.dart</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teste ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"get mais recente teste de número cômico"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , () assíncrona {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">①</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> latestComicNumberFile = MeuArquivo ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> latestComicNumberExists = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falso</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cordas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> latestComicNumberString;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mockHttp = MockHTTPClient ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">②</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (mockHttp.read ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'https://xkcd.com/info.0.json'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) =&gt; Future.value (quadrinhos [1])</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">③</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicNumberFile.createSync ()). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestComicNumberExists = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verdadeiro</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">④</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicNumberFile.create ()). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestComicNumberExists = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verdadeiro</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Future.value (latestComicNumberFile);</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">⑤</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicNumberFile.writeAsStringSync ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"2"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestComicNumberExists = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verdadeiro</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestComicNumberString = </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"2"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">⑥</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicNumberFile.writeAsString ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"2"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestComicNumberExists = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verdadeiro</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestComicNumberString = </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"2"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Future.value (latestComicNumberFile);</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">⑦</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicNumberFile.existsSync ()). thenReturn (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    latestComicNumberExists</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">⑧</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicNumberFile.exists ()). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) =&gt;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      Future.value (latestComicNumberExists)</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">⑨</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicNumberFile.readAsStringSync ()). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="comment"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">// se tentarmos ler um arquivo que não existe fizemos um erro</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assert</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (latestComicNumberExists, </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verdadeiro</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voltar </font></font></strong><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"2"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">⑩</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicNumberFile.readAsString ()). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assert</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (latestComicNumberExists, </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verdadeiro</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Future.value (latestComicNumberString);</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">⑪</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  Espero(</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    aguarde getLatestComicNumber (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      httpClient: mockHttp,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestComicNFile: latestComicNumberFile,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    ),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    2</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">});</font></font></td>
    </tr>

  </tbody></table>

  <dl class="calloutlist">

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">①</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e32641"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      É aqui que declaramos os objetos fictícios e alguns dados sobre os quais operam: um </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arquivo</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fictício </font><font style="vertical-align: inherit;">que usa um </font></font><span class="cf keyword"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bool</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para rastrear se foi criado e uma </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">String</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para simular o armazenamento de uma string. </font><font style="vertical-align: inherit;">Também declaramos um cliente HTTP simulado.
    </font></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">②</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e32653"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Este é o primeiro de nossos </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quando</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chama e é o único para o cliente HTTP simulado: ele retorna nosso último quadrinho falso quando tentamos acessá-lo.
    </font></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">③</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e32661"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Agora precisamos definir o </font></font><span class="cf variable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comportamento</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do </font><span class="cf variable"><font style="vertical-align: inherit;">latestComicNumberFile</font></span><font style="vertical-align: inherit;"> : começaremos com o método síncrono para criar o arquivo, que mudará o </font><font style="vertical-align: inherit;">booleano </font></font><span class="cf variable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">latestComicNumberExists</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para verdadeiro. </font><font style="vertical-align: inherit;">Isso vai ser importante quando tentamos ler o arquivo ou executar o </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">existe</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">existsSync</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> métodos.
    </font></font></p>

      <p id="d24e32675"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Nos parênteses, usamos </font></font><span class="cf variable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que deve ser usado para argumentos não usados ​​(também pode ser usado em </font><font style="vertical-align: inherit;">blocos </font></font><span class="cf keyword"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">catch</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Se tivéssemos escolhido usar esse argumento e dar a ele um nome, seria uma </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">invocação</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .
    </font></font></p>

      <p id="d24e32686"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Uma invocação tem algumas propriedades que são interessantes para nós: </font></font></p>

      <ul>

        <li>

          <p id="d24e32690"> <span class="cf variable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">namedArguments</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que é um </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mapa</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dos argumentos nomeados fornecidos pelo </font><span class="cf variable"><font style="vertical-align: inherit;">responsável</font></span><font style="vertical-align: inherit;"> pela chamada;</font></font></p>

        </li>

        <li>

          <p id="d24e32699"> <span class="cf variable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">posicionalArguments</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que é uma </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lista</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dos argumentos posicionais fornecidos pelo </font><font style="vertical-align: inherit;">responsável </font><font style="vertical-align: inherit;">pela chamada.</font></font></p>

        </li>

      </ul>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">④</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e32708"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Estamos fazendo a mesma coisa para o método assíncrono de criação de arquivos, que deve retornar o arquivo (em um </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">futuro</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , já que é um </font><font style="vertical-align: inherit;">método </font></font><span class="cf keyword"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assíncrono</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).
	  
    </font></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">⑤</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e32722"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Em algum ponto, </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getLatestComicNumber</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deve tentar gravar o número 2 em um arquivo. </font></font><span class="cf variable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simularemos a</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> escrita armazenando-o em </font><span class="cf variable"><font style="vertical-align: inherit;">latestComicNumberString</font></span><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Também simulamos a criação do arquivo ao mesmo tempo, da mesma forma que os métodos reais de gravação de arquivos fazem.
    </font></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">⑥</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e32731"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      É igual ao anterior, mas assíncrono. </font><font style="vertical-align: inherit;">Retornamos o arquivo pelo mesmo motivo que o devolvemos em </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">create</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .
    </font></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">⑦</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e32737">
      <span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getLatestComicNumber</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verifica se o arquivo existe em algum ponto, portanto, precisamos ser capazes de implementar esse método também.
    </font></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">⑧</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e32743"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Ter objetos fictícios que implementam métodos que podem ser usados ​​no método que estamos tentando testar, mesmo que não sejam usados, permite que o objeto fictício seja usado sem alterações para mais testes e faz com que não tenhamos que mudar o teste se em algum ponto alterarmos as funções usadas no método que estamos testando. </font><font style="vertical-align: inherit;">Nesse caso, implementamos métodos assíncronos e síncronos, mesmo quando usamos apenas um deles.
    </font></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">⑨</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e32746"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Isso simula a leitura de um arquivo. </font><font style="vertical-align: inherit;">Temos uma afirmação que interrompe a execução se tentarmos ler um arquivo que ainda não foi criado (executando </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">criar</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou gravando nele.
    </font></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">⑩</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e32752"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      A versão assíncrona do método anterior.
    </font></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">⑪</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e32755"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Por fim, podemos </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esperar</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , passando o cliente HTTP simulado e o arquivo e esperando que ele retorne </font></font><span class="emph"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .
    </font></font></p>

    </dd>

  </dl>

  <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teste para obter o quadrinho mais recente</font></font></h4>

  <p id="d24e32766"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font><font style="vertical-align: inherit;">método </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tem uma característica importante: ele não é realmente definido como </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mas, em vez disso, é chamado de </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o que o torna privado: ele só é acessível dentro da própria classe. </font><font style="vertical-align: inherit;">É uma boa prática definir todos os membros da classe como privados se eles não devem ser acessados ​​de fora da classe, mas precisamos chamá-lo diretamente para realizar testes de unidade nele. </font><font style="vertical-align: inherit;">Isso significa que precisamos mudar sua definição de:</font></font></p>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Futuro &lt;Map &lt; </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">string</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dinâmico</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt;&gt; fetchComic</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corda</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    http.Client httpClient,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    Arquivo comicFile,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    File imageFile,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cordas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imagepath</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) assíncrono</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e32816"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para:</font></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/testing/xkcd_app/lib/main.dart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">testando / xkcd_app / lib / main.dart</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Futuro &lt;Map &lt; </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">string</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dinâmico</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt;&gt; fetchComic</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corda</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    http.Client httpClient,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    Arquivo comicFile,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    File imageFile,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cordas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imagepath</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) assíncrono</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e32857"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso também significa que precisamos alterar qualquer chamada para </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para chamadas para </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nesse caso, é apenas um e é definido como o </font><font style="vertical-align: inherit;">argumento </font></font><span class="cf variable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">futuro</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FutureBuilder</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no </font><font style="vertical-align: inherit;">método de </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">construção</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p>

  <p id="d24e32874"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tendo em conta que nós também precisamos testar o </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SelectionPage</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‘s eo </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HomeScreen</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‘s </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , as mesmas alterações precisam ser feitas a essas classes. </font><font style="vertical-align: inherit;">O </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StarredPage</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é chamado apenas dentro de </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_retrieveSavedComics</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e o </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HomeScreen</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é definido como o </font></font><span class="cf variable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">futuro</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de um </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FutureBuilder</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dentro do </font><font style="vertical-align: inherit;">método de </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">construção</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p>

  <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testando fetchComic</font></font></strong></p>

  <p id="d24e32910"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este é o código para testar a </font><font style="vertical-align: inherit;">capacidade </font><font style="vertical-align: inherit;">do </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SelectionPage </font></font></span> <span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de buscar a história em quadrinhos número 2:</font></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/testing/xkcd_app/test/unit_test.dart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">testando / xkcd_app / test / unit_test.dart</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teste ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"SelectionPage fetchComic mais recente"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , () assíncrona {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> latestComicFile = MeuArquivo ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> latestComicExists = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falso</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cordas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> latestComicString;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> latestImageFile = MeuArquivo ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  Uint8List latestImageData;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> latestImageExists = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falso</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mockHttp = MockHTTPClient ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (mockHttp.read ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'https://xkcd.com/2/info.0.json'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) =&gt; Future.value (quadrinhos [1])</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (mockHttp.readBytes ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"https://example.com/2.png"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) =&gt; Future.value (Uint8List.fromList ([2]))</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicFile.createSync ()). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestComicExists = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verdadeiro</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicFile.create ()). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestComicExists = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verdadeiro</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Future.value (latestComicFile);</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicFile.writeAsStringSync (comics [1])). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestComicExists = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verdadeiro</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestComicString = comics [1];</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicFile.writeAsString (comics [1])). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestComicExists = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verdadeiro</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestComicString = comics [1];</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Future.value (latestComicFile);</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicFile.existsSync ()). thenReturn (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    latestComicExists</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicFile.exists ()). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) =&gt;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      Future.value (latestComicExists)</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicFile.readAsStringSync ()). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="comment"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ *</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="comment"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">       * Se tentarmos ler um arquivo que não faz</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="comment"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">       * Existem é porque nós fizemos um erro</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="comment"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">       * /</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assert</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (latestComicExists, </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verdadeiro</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voltar</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> latestComicString;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestImageFile.readAsBytes ()). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assert</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (latestImageExists, </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verdadeiro</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Future.value (latestImageData);</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando(</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    latestImageFile.writeAsBytesSync (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      Uint8List.fromList ([1])</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    )</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  ).A resposta(</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestImageExists = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verdadeiro</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestImageData = Uint8List.fromList ([1]);</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  quando (latestComicFile.writeAsString (comics [1])). thenAnswer (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    (_) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestImageExists = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verdadeiro</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      latestImageData = Uint8List.fromList ([1]);</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Future.value (latestImageFile);</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> selPage = SelectionPage ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  Espero(</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    aguarde selPage.fetchComic (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"2"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      httpClient: mockHttp,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      comicFile: Arquivo ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"latestComicFole"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      imageFile: Arquivo ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"latestComicFile"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      imagepath: </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"https://example.com/2.png"</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    ),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    json.decode (quadrinhos [1])</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">});</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e33331"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Não é nada novo: usamos o Mockito para definir o comportamento esperado para todas as funções que podem ser chamadas pelo </font><font style="vertical-align: inherit;">método </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para buscar o quadrinho: ler e escrever a partir de arquivos de imagem e quadrinhos e realizar solicitações HTTP.</font></font></p>

  <p id="d24e33336"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A definição de novos testes para outros </font><font style="vertical-align: inherit;">métodos </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> requer apenas alterações para a </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HomeScreen</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : ela precisa de um inteiro para o número do quadrinho, que é um número que começa em 0 e pode ser, no máximo, 1 a menos que o último número do quadrinho.</font></font></p>

  <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testes de agrupamento</font></font></strong></p>

  <p id="d24e33347"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vários testes podem ser agrupados usando o </font><font style="vertical-align: inherit;">método de </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grupo</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que funciona exatamente como </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teste</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font></p>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grupo ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"nome do grupo"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , () {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  teste ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"primeiro teste no grupo"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , () {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="comment"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">// primeiro teste em grupo</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  });</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  teste ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"segundo teste no grupo"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , () {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="comment"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">// Segundo teste em grupo</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  });</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><em class="comment"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">// quaisquer outros testes que você deseja adicionar</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">});</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e33390"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por exemplo, podemos agrupar todos os testes que envolvem </font><font style="vertical-align: inherit;">métodos </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou talvez possamos agrupar todos os testes que buscam um quadrinho específico se você decidir estruturar os testes de forma diferente. </font><font style="vertical-align: inherit;">Dentro dos </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grupos</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , podemos, por exemplo, definir variáveis ​​e objetos fictícios que são necessários para mais de um teste, de modo que sejam acessíveis por todos os testes em um grupo, mas não fora do grupo, mas você precisa ter em mente que o </font><font style="vertical-align: inherit;">o encerramento de retorno de chamada do </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grupo</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> não pode ser </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assíncrono</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p>

  <div class="sidebar">

    <div class="sidebar-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais testes de unidade: Comic Starring</font></font></div>

    <div class="sidebar-content">

      <p id="d24e33407"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Testar quadrinhos estrelando em </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StarredPage</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> não apresenta situações particularmente desafiadoras, exceto pelo fato de que o </font><font style="vertical-align: inherit;">método </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retrieveSavedComics</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chama </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o que significa que os objetos simulados precisam ser passados ​​primeiro para </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retrieveSavedComics</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que, por sua vez, os passará para </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .
  </font></font></p>

      <p id="d24e33424"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    A estrutura geral do teste deve ser a seguinte: o </font><font style="vertical-align: inherit;">método </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">addToStarred</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (no </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ComicPage</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) deve ser chamado no mesmo arquivo que será usado por </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retrieveStarredComics</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para obter a lista de quadrinhos estrelados. </font><font style="vertical-align: inherit;">A principal diferença entre este teste e o </font><font style="vertical-align: inherit;">teste </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é que este precisa de dois arquivos de texto fictícios: um deles precisa conter o arquivo de quadrinhos, enquanto o outro armazenará a lista de números de quadrinhos salvos, portanto, precisa prever os dados ele será solicitado a armazenar, assim como fizemos anteriormente para os arquivos de quadrinhos e os últimos números.
  </font></font></p>

      <p id="d24e33438"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Escrever esses testes como alguém que está tentando entender o Flutter também ajudará você a entender o funcionamento interno de nosso aplicativo com mais detalhes e testar sua própria compreensão dele. </font><font style="vertical-align: inherit;">Se você não pode escrever um teste para ele, provavelmente não entende como ele está funcionando e isso significa que você precisa tentar primeiro entender como o aplicativo funciona.
  </font></font></p>

    </div>

  </div>

  <h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algumas palavras sobre widget testando aplicativos mais complicados</font></font></h3>

  <p id="d24e33443"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">





Já cobrimos o teste de widget na seção sobre o teste da calculadora, portanto, não teremos exemplos de testes de widget para os aplicativos XKCD, o que seria redundante.</font></font></p>

  <p id="d24e33463"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O teste de widget do aplicativo XKCD envolve testar se a IU realmente funciona ou não, portanto, não precisamos ser necessariamente objetos de simulação de design que emulem perfeitamente o comportamento da rede ou do sistema de arquivos: só precisamos saber se existe a IU de que precisamos e está interagindo corretamente com o backbone de nosso aplicativo.</font></font></p>

  <p id="d24e33467"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os testes de widget dependem de objetos simulados para funcionar, portanto, reduzir o escopo desses testes para apenas testar se os widgets chamam as funções que deveriam chamar é tudo o que deve ser feito nos testes de widget: fazer qualquer coisa além disso só fará os testes mais complicado e torna os testes de integração parcialmente redundantes.</font></font></p>

  <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verificando se um método foi chamado: Mockito's verify</font></font></h4>

  <p id="d24e33472"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">

O Mockito inclui uma função para verificar se um método foi ou não chamado, tornando possível reduzir o escopo dos testes para apenas verificar se os métodos são chamados em vez de necessariamente verificar se um determinado método retorna um determinado valor. </font><font style="vertical-align: inherit;">Por exemplo, se quiser que o teste falhe se </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myObj.runMethod ()</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> não tiver sido chamado, adicione:</font></font></p>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verificar (myObj.runMethod ());</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e33499"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se você substituiu </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verifique</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> por </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verifyNever,</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> teria o efeito oposto.</font></font></p>

  <p id="d24e33507"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Você também pode especificar a quantidade de vezes que um método deve ser chamado:</font></font></p>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verificar (myObj.runMethod ()). chamado (5);</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e33519"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requer que o método tenha sido chamado 5 vezes e:</font></font></p>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verificar (myObj.runMethod ()). chamado (maiorThan (4));</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e33532"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requer que ele tenha sido chamado </font></font><span class="emph"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pelo menos</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 5 vezes.</font></font></p>

  <p id="d24e33537"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A chamada de </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verify (myObj.runMethod ()). Called (0)</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> irá falhar. </font><font style="vertical-align: inherit;">Você tem que usar </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verifyNever (myObj.runMethod ())</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para isso.




</font></font></p>

  <h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teste de integração de aplicativo XKCD</font></font></h3>

  <p id="d24e33558"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">



Os testes de integração são como testes de widget, mas são executados em um dispositivo ou emulador real usando o </font><font style="vertical-align: inherit;">pacote </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flutter_driver</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p>

  <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modificando o aplicativo: usando um TextEditingController</font></font></h4>

  <p id="d24e33583"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O teste de integração exige que façamos modificações no aplicativo. </font><font style="vertical-align: inherit;">Uma das principais modificações é a adição de chaves a quaisquer widgets com os quais queremos interagir, especialmente se eles não contiverem texto ou precisarmos verificar o texto que contêm.</font></font></p>

  <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encontrando um velho amigo novamente: a necessidade de uma chave</font></font></strong></p>

  <p id="d24e33588"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">


Isso ocorre porque o teste de widget e o </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finder de</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> teste de integração </font><font style="vertical-align: inherit;">são muito semelhantes, mas não o mesmo: o teste de integração usa </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SerializableFinders</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que são muito menos, e nos permitem apenas as seguintes operações:




</font></font></p>

  <ul>

    <li>

      <p id="d24e33637"><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find.byValueKey (value)</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que encontra objetos com </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Key</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> s ou </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ValueKey</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> s anexados a eles que são gerados usando aquele </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valor</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p>

    </li>

    <li>

      <p id="d24e33651"><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find.text (texto)</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que encontra </font><font style="vertical-align: inherit;">widgets de </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Texto</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contendo o </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">texto</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fornecido </font><font style="vertical-align: inherit;">.</font></font></p>

    </li>

    <li>

      <p id="d24e33662"><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find.byType (tyoe)</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que encontra widgets de um determinado </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tipo</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p>

    </li>

    <li>

      <p id="d24e33670"><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find.byTooltip (tooltip)</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que encontra o widget mostrando a </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dica de ferramenta</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fornecida </font><font style="vertical-align: inherit;">quando pressionado por muito tempo.</font></font></p>

    </li>

    <li>

      <p id="d24e33678"><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find.pageBack</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que encontra o botão para ir para a página anterior.</font></font></p>

    </li>

  </ul>

  <p id="d24e33682"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta é a melhor maneira de encontrar widgets com recursos que não estão em conformidade com nenhum dos outros, temos que equipar o widget com uma chave e usar </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find.byValueKey</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para encontrá-lo.</font></font></p>

  <p id="d24e33687"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A razão pela qual eles são tão poucos é porque os testes de integração não devem ter acesso aos recursos do aplicativo ou aos widgets e classes do Flutter UI framework em geral.</font></font></p>

  <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicionando um botão para enviar a entrada do TextField</font></font></strong></p>

  <p id="d24e33692"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Além disso, precisamos fazer uma alteração na </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SelectionPage</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : no momento o usuário só pode enviar usando o número usando o botão enviar no teclado na tela ou a </font><font style="vertical-align: inherit;">tecla </font></font><span class="keystroke"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enter</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> em um teclado físico. </font><font style="vertical-align: inherit;">Isso, infelizmente, não é suportado pela infraestrutura de teste de integração do Flutter (no momento da escrita), o que significa que temos que criar um </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TextEditingController</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e um </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlatButton</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> separado </font><font style="vertical-align: inherit;">para enviar o </font><font style="vertical-align: inherit;">conteúdo </font><font style="vertical-align: inherit;">do </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TextField</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p>

  <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Definindo um TextEditingController</font></font></strong></p>

  <p id="d24e33712"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TextEditingController</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é uma classe que armazena os dados inseridos em um </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TextField</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou widget semelhante e torna possível acessar esses dados de fora do </font><font style="vertical-align: inherit;">callback </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onSubmitted</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que damos ao </font><font style="vertical-align: inherit;">próprio </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TextField</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , permitindo-nos criar um botão que abre a história em quadrinhos que o usuário pediu para, e nos dando algo para tocar para fazer isso ao executar testes de integração.</font></font></p>

  <p id="d24e33735"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos declarar um </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TextEditingController</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> como uma variável de membro privada da </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SelectionPage</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/testing/xkcd_app/lib/main.dart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">testando / xkcd_app / lib / main.dart</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">definitiva</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> _controller TextEditingController = TextEditingController ();</font></font></td>
    </tr>

  </tbody></table>

  <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usando o TextEditingController</font></font></strong></p>

  <p id="d24e33752"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos passá-lo como o </font><font style="vertical-align: inherit;">argumento </font><font style="vertical-align: inherit;">do </font></font><span class="cf variable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">controlador</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para o </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TextField</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/testing/xkcd_app/lib/main.dart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">testando / xkcd_app / lib / main.dart</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Campo de texto(</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> controlador: _controller,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> decoração: InputDecoration (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">   labelText: </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Insert quadrinhos #"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ),</font></font></td>
    </tr>

  </tbody></table>

  <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicionando o FlatButton</font></font></strong></p>

  <p id="d24e33778"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agora precisamos transformar o </font><font style="vertical-align: inherit;">widget </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Center</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no </font></font><span class="cf variable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">corpo</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scaffold</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> em uma </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coluna</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o que também exigirá a alteração do </font><font style="vertical-align: inherit;">argumento </font></font><span class="cf variable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filho</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para </font></font><span class="cf variable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filhos</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que precisa ser um </font><font style="vertical-align: inherit;">literal de </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lista</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (precisamos colocar a </font><font style="vertical-align: inherit;">definição de </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TextField</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entre colchetes, em que também adicionaremos o </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlatButton</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></p>

  <p id="d24e33808"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlatButton</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vamos adicionar as necessidades de uma </font></font><span class="cf variable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chave</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para ser usado em testes de integração, e ele precisa para executar as mesmas ações executadas pelo </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TextField</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‘s </font></font><span class="cf variable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onSubmit</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mas tomando o número dos quadrinhos solicitado pelo usuário a partir </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_controller.text</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Todo o </font></font><span class="cf variable"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">corpo</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andaime</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> acaba sendo o seguinte:</font></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/testing/xkcd_app/lib/main.dart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">testando / xkcd_app / lib / main.dart</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">corpo: coluna (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  mainAxisAlignment: MainAxisAlignment.center,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  crianças: [</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    Campo de texto(</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">     controlador: _controller,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">     decoração: InputDecoration (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">       labelText: </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Insert quadrinhos #"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">     ),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">     keyboardType: TextInputType.number,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">     autofocus: </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verdade</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">     onSubmitted: ( </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">string</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a) =&gt; Navigator.push (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">       contexto,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">       MaterialPageRoute (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">         construtor: (contexto) =&gt; FutureBuilder (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">           futuro: fetchComic (a),</font></font></td>
    </tr>

  </tbody></table>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">           construtor: (contexto, instantâneo) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (snapshot.hasError)</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">regresso</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ErrorPage ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (snapshot.hasData)</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ComicPage (snapshot.data);</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">regresso</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CircularProgressIndicator ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">           }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">         ),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">       ),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">     ),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">     chave: Chave ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"inserir quadrinhos"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">   ),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">   FlatButton (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">     chave: Chave ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"enviar quadrinhos"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">     criança: Texto ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Open"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .toUpperCase ()),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">     onPressed: () =&gt; Navigator.push (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">       contexto,</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">       MaterialPageRoute (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">         construtor: (contexto) =&gt; FutureBuilder (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">           futuro: fetchComic (_controller.text),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">           construtor: (contexto, instantâneo) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (snapshot.hasError)</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">regresso</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ErrorPage ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (snapshot.hasData)</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ComicPage (snapshot.data);</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">regresso</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CircularProgressIndicator ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">           }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">         ),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">       ),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">     ),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">   )</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  ],</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">),</font></font></td>
    </tr>

  </tbody></table>

  <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usando flutter_driver para testar a página de seleção</font></font></h4>

  <p id="d24e34023"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O teste de integração requer um pacote chamado </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flutter_driver</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Todo o </font><font style="vertical-align: inherit;">arquivo </font></font><span class="cf filename"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pubspec.yaml</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contendo todas as dependências necessárias para testar aplicativos Flutter (junto com as outras dependências que precisamos para executar o aplicativo XKCD) é o seguinte:</font></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/testing/xkcd_app/pubspec.yaml"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">testando / xkcd_app / pubspec.yaml</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nome: </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xkcd_app</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descrição: </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um aplicativo para quadrinhos exibição XKCD.</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dependências:</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  http: </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font></em><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">^ 0.12.0 + 1"</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  path_provider:</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  url_launcher: </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">^ 5.0.2</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  vibração:</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    SDK: </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vibração</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

  </tbody></table>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dev_dependencies:</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  flutter_driver:</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    SDK: </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vibração</font></font></em><font style="vertical-align: inherit;"></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  mockito:</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  teste:</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vibração:</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  usa-material-design: verdadeiro</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e34123"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para usá-lo, vamos criar um novo diretório na raiz da árvore de origem do nosso aplicativo chamado </font></font><span class="cf filename"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">test_driver</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dentro dele, precisamos criar um arquivo que executará o aplicativo com as extensões do driver Flutter habilitadas e outro que se conectará ao aplicativo em execução e realizará alguns testes nele.</font></font></p>

  <p id="d24e34128"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como exemplo, vamos explorar como podemos interagir com a </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SelectionPage</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e ver o que é possível fazer com a estrutura de teste de integração Flutter.</font></font></p>

  <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criando um arquivo selectionpage.dart</font></font></strong></p>

  <p id="d24e34136"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos começar criando um arquivo que habilite as extensões do driver Flutter:</font></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/testing/xkcd_app/test_driver/selectionpage.dart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">testando / xkcd_app / test_driver / selectionpage.dart</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">①</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">importação </font></font></strong><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'pacote: flutter_driver / driver_extension.dart'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">importação </font></font></strong><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'pacote: xkcd_app / main.dart' </font></font></em><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aplicativo;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">importação </font></font></strong><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'pacote: vibração / material.dart'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vazio </font></font></strong><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">principal</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> () {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">②</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  enableFlutterDriverExtension (); </font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">③</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  runApp ( </font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    MaterialApp (</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      home: app.SelectionPage (),</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    )</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></td>
    </tr>

  </tbody></table>

  <dl class="calloutlist">

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">①</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e34193">
      <span class="emph"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">package: flutter_driver / driver_extension.dart</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é a parte do </font></font><span class="emph"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flutter_driver</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que nos permite habilitar </font></font><span class="emph"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extensões de driver</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que precisam ser habilitadas ao executar um aplicativo no qual queremos executar testes de integração.
    </font></font></p>

      <p id="d24e34204"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Também precisamos importar </font></font><span class="cf filename"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.dart</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do aplicativo </font><font style="vertical-align: inherit;">porque precisamos ser capazes de executar o aplicativo e precisamos importar a biblioteca de Material Design do Flutter porque queremos apenas executar a </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SelectionPage</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> neste caso, então precisamos acessar </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">runApp</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e a </font><font style="vertical-align: inherit;">classe </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MaterialApp</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .
	  
    </font></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">②</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e34224">
      <span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enableFlutterDriverExtension</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> realmente ativa as extensões do driver. </font><font style="vertical-align: inherit;">Esta função está contida no </font></font><span class="emph"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pacote: flutter_driver / driver_extension.dart</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .
    </font></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">③</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e34233"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Queremos testar a página de seleção, portanto, a executamos da mesma forma que executamos as telas iniciais de aplicativos normais quando construímos aplicativos Flutter, mas selecionando </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SelectionPage</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .
    </font></font></p>

    </dd>

  </dl>

  <p id="d24e34241"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este é o único arquivo que terá acesso ao seu aplicativo ou às classes de IU do Flutter. </font><font style="vertical-align: inherit;">O arquivo de teste real não deve importar nada disso.</font></font></p>

  <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criação de um arquivo selectionpage_test.dart</font></font></strong></p>

  <p id="d24e34246"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este nome de arquivo precisa ser igual ao anterior, mas com </font></font><span class="emph"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_test</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adicionado ao nome antes da </font><font style="vertical-align: inherit;">extensão </font></font><span class="emph"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.dart</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Neste caso, deve ser chamado </font></font><span class="cf filename"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selectionpage_test.dart</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p>

  <p id="d24e34257"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este teste será muito simples e tentará simplesmente abrir uma história em quadrinhos e verificar se ela está aberta corretamente pelo aplicativo:</font></font></p>

  <div class="livecodelozenge"><a href="http://media.pragprog.com/titles/czflutr/code/testing/xkcd_app/test_driver/selectionpage_test.dart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">testando / xkcd_app / test_driver / selectionpage_test.dart</font></font></a></div>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">①</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">importação </font></font></strong><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'pacote: flutter_driver / flutter_driver.dart'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">importação </font></font></strong><font style="vertical-align: inherit;"></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'pacote: test / test.dart'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vazio </font></font></strong><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">principal</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> () {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  grupo ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'Seleção Página'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , () {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">②</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    Driver FlutterDriver; </font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    SerializableFinder appBarText = find.byValueKey ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"text AppBar"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">③</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    setUpAll (() async { </font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      driver = espera FlutterDriver.connect ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    });</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">④</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    tearDownAll (() async { </font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (driver! = </font></font><strong class="kw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) {</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">        driver.close ();</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      }</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    });</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">⑤</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    teste ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'Verificar página é carregada'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , () {async</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      aguarde driver.waitFor (appBarText);</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      esperar (driver.getText await (appBarText), </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"seleção Comic"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    });</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline">
    </td></tr>

    <tr>
      <td class="codeinfo"><font style="vertical-align: inherit;"><span class="codeprefix"><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;">⑥</font></span></span></font><span class="codeprefix"><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    teste ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'Comic Open'</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , () {async</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      driver.tap Await (find.byValueKey ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"inserção desenhada"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ));</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      Await driver.enterText ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"1"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      driver.tap await (find.byValueKey ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"enviar quadrinhos"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ));</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      aguardam driver.waitFor (find.text ( </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"# 1"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ));</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">      esperar (driver.getText await (appBarText), </font></font><em class="string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"# 1"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    });</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  });</font></font></td>
    </tr>

    <tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></td>
    </tr>

  </tbody></table>

  <dl class="calloutlist">

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">①</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e34415"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Aqui, precisamos importar o </font><font style="vertical-align: inherit;">arquivo </font></font><span class="cf filename"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flutter_driver.dart</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> principal </font><font style="vertical-align: inherit;">, junto com o pacote de teste regular.
    </font></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">②</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e34421"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Vamos definir algumas das variáveis ​​que usaremos mais de uma vez: o </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlutterDriver</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que usaremos para interagir com o aplicativo Flutter em execução e o </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SerializableFinder</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> procurando por uma </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chave</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> criada com a string </font></font><span class="emph"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AppBar text</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que você deve adicionar cada </font><font style="vertical-align: inherit;">widget de </font><span class="cf class"><font style="vertical-align: inherit;">texto </font></span></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AppBar</font></font></span> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no aplicativo.
    </font></font><span class="cf class"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">③</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e34443"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Esta seção é usada para conectar ao aplicativo em execução ao iniciar o teste.
    </font></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">④</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e34446"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Aqui, nos desconectamos do aplicativo quando o teste termina.
    </font></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">⑤</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e34449"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Este primeiro teste é muito simples: esperamos a página carregar e depois verificamos se o </font><font style="vertical-align: inherit;">texto </font><font style="vertical-align: inherit;">do </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AppBar</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> está correto (para que saibamos que o aplicativo carregou a página certa).
    </font></font></p>

    </dd>

    <dt><font style="vertical-align: inherit;"></font><span class="callout-number" style="font-family:Quivira;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">⑥</font></font></span><font style="vertical-align: inherit;"></font></dt>

    <dd>

      <p id="d24e34455"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Este teste é mais importante: encontramos o </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TextField</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para inserir o quadrinho, tocamos nele (para selecioná-lo, por precaução), inserimos o texto </font></font><span class="emph"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pressionamos o </font><font style="vertical-align: inherit;">botão de </font></font><span class="emph"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">envio</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recém-criado </font><font style="vertical-align: inherit;">, esperamos que a página do quadrinho carregue, e verifique se a história em quadrinhos número 1 foi realmente carregada (o </font><span class="cf class"><font style="vertical-align: inherit;">texto</font></span><font style="vertical-align: inherit;"> do </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AppBar</font></font></span> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deve ser o </font><span class="emph"><font style="vertical-align: inherit;">número 1</font></span><font style="vertical-align: inherit;"> ).
    </font></font><span class="cf class"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font><span class="emph"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></p>

    </dd>

  </dl>

  <p id="d24e34476"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para iniciar o teste, execute o seguinte comando com um emulador ou dispositivo conectado:</font></font></p>

  <table class="processedcode">

    <tbody><tr>
      <td class="codeinfo">​<span class="codeprefix">&nbsp;</span></td>
      <td class="codeline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flutter drive --target = test_driver / selectionpage.dart</font></font></td>
    </tr>

  </tbody></table>

  <p id="d24e34489"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e você verá o aplicativo aberto e fará tudo o que você pediu automaticamente. </font><font style="vertical-align: inherit;">Na linha de comando, você obterá a confirmação de que todos os testes foram aprovados.

</font></font></p>

  <h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testando mais</font></font></h3>

  <p id="d24e34497"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em nosso exemplo de teste de integração, estamos apenas testando a </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SelectionPage</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Isso porque nos permite combinar muitos </font><font style="vertical-align: inherit;">recursos </font><font style="vertical-align: inherit;">interessantes do </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flutter_driver</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e não exige a repetição das mesmas instruções muitas vezes, o que não seria muito interessante para um exemplo que visa ajudá-lo a aprender coisas novas.</font></font></p>

  <p id="d24e34509"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Não fizemos o teste de integração no aplicativo de calculadora, mas ele pode ser usado para testar a execução de cálculos usando o teclado, testando o </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cálculo</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e a IU, e isso é simplesmente uma combinação de testes que já fizemos: é útil em um aplicativo real, mas você já sabe como fazer isso. </font><font style="vertical-align: inherit;">É para isso que serve o teste de integração, assim como o teste que escrevemos para nosso aplicativo XKCD: ele testa tanto a IU quanto a lógica.</font></font></p>

  <p id="d24e34514"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testar a base de código é essencial e deve ser feito tanto quanto possível. </font><font style="vertical-align: inherit;">Ao escrever seus próprios aplicativos, é importante que você projete e escreva todos os três tipos de testes para cada aspecto do aplicativo: nosso aplicativo XKCD precisa de testes para a </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HomeScreen</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , para o </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ComicPage</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , talvez testando se a </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ErrorPage</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é mostrada quando necessário. </font><font style="vertical-align: inherit;">Além disso, mais testes de unidade e testes de widget para os elementos básicos da IU são úteis (por exemplo, testar os </font><font style="vertical-align: inherit;">controles </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AppBar</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na </font></font><span class="cf class"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tela inicial</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).

</font></font></p>

  <p id="d24e34535"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os exemplos de código desses casos de teste se parecem muito com os anteriores e, portanto, não os reproduzi aqui; </font><font style="vertical-align: inherit;">no entanto, você precisa ter em mente a importância dos testes.</font></font></p>

  <h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando temos que zombar e quando não temos</font></font></h3>

  <p id="d24e34540"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Testar usando objetos simulados pode ser repetitivo e parece um exercício inútil de pedantismo e correção, muitas vezes levando à pergunta: </font></font><span class="emph"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isso é realmente necessário?</font></font></span></p>

  <p id="d24e34550"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testar software parece uma tarefa fácil quando não há simulação envolvida: apenas executamos um método e verificamos se ele retorna o valor correto ou simulamos a interação do usuário e verificamos se o aplicativo se comporta corretamente: é simples, intuitivo e não envolve escrever muitas linhas de código para coisas simples.</font></font></p>

  <p id="d24e34552"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escrever objetos fictícios não é tão simples e direto: precisamos considerar cada interação do aplicativo com o mundo externo e simular a resposta do mundo externo: é, em muitos aspectos, uma tarefa árdua e parece prejudicar do tempo que poderia ser gasto no desenvolvimento de um novo recurso, sem realmente alcançar nada de novo.</font></font></p>

  <p id="d24e34554"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O problema com a simulação é que não se trata apenas de proteger contra variáveis ​​externas imprevisíveis: trata-se de fazer os testes realmente funcionarem. </font><font style="vertical-align: inherit;">Mesmo que o teste funcione corretamente se não simularmos o cliente HTTP (embora não possamos realmente testar a funcionalidade do aplicativo com base em seu resultado), qualquer tentativa de chamar as funções fornecidas por </font></font><span class="cf ic"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">path_provider</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para acessar o caminhos onde armazenar arquivos de aplicativos resultarão em exceções sendo lançadas.</font></font></p>

  <p id="d24e34559"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se quisermos saber se o </font><font style="vertical-align: inherit;">método </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchComic</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> funciona, não podemos simplesmente tornar opcional a parte que funciona com arquivos: é parte integrante do funcionamento correto do aplicativo e isso significa que precisamos testá-la. </font><font style="vertical-align: inherit;">A melhor maneira de testá-lo em testes que não são executados dentro de um emulador é simular arquivos, então é isso que fazemos.</font></font></p>

  <p id="d24e34564"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este caso de uso, como vimos, pode ser facilitado apenas com o uso de arquivos reais na máquina física que executa os testes: apenas executar o </font><font style="vertical-align: inherit;">construtor de </font></font><span class="cf methodname"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arquivo</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> criará um arquivo na máquina que você está usando para executar os testes, e essa é uma maneira de tornar o teste mais fácil, mas não muito previsível ou controlado, uma vez que depende do sistema de arquivos da máquina local, que pode ser inacessível caso o teste seja executado em um servidor que não permite que o código tenha acesso de gravação para o sistema de arquivos.</font></font></p>

  <p id="d24e34569"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Além disso, um recurso importante que absolutamente requer objetos simulados, mesmo em testes de integração, é a autenticação: um aplicativo que requer autenticação para funcionar torna o teste impossível, a menos que os testes aproveitem a simulação para superar o problema de autenticação.
</font></font></p>

  <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mockito versus objetos de simulação do tipo "faça você mesmo"</font></font></h4>

  <p id="d24e34579"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">

Mockito nem sempre facilita a criação de objetos fictícios: pelo contrário, às vezes você pode achar mais fácil apenas escrever uma classe que implemente os métodos que você precisa. </font><font style="vertical-align: inherit;">Você pode fazê-los funcionar, definindo essas classes como subclasses ( </font><a href="http://localhost:8080/html/Cap%C3%ADtulo-092.html#sec.dart.extends"><em><font style="vertical-align: inherit;">estende</font></em></a><font style="vertical-align: inherit;"> ) ou como classes que implementam ( </font><a href="http://localhost:8080/html/Cap%C3%ADtulo-092.html#sec.dart.implements"><em><font style="vertical-align: inherit;">escrevendo uma classe que implementa uma interface</font></em></a><font style="vertical-align: inherit;"> ) a interface que você quer zombar.</font></font><a href="http://localhost:8080/html/Cap%C3%ADtulo-092.html#sec.dart.extends"><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="http://localhost:8080/html/Cap%C3%ADtulo-092.html#sec.dart.implements"><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./Capítulo-072_files/translate_24dp.png" width="20" height="20" alt="Google Tradutor"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">Texto original</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">Sugerir uma tradução melhor</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div>



<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div></body></html>